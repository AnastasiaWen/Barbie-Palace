import np
import numpy
import math
from scipy.signal import find_peaks
def getSPO2andPhase(x1,x2):
    #x: 带有峰值的信号序列
    #height: 低于指定height的信号都不考虑
    #threshold: 其与相邻样本的垂直距离
    #distance: 相邻峰之间的最小水平距离, 先移除较小的峰，直到所有剩余峰的条件都满足为止。
    #prominence: 个人理解是突起程度，详见peak_prominences
    #width: 波峰的宽度，详见peak_widths
    #plateau_size: 保证峰对应的平顶数目大于给定值
    #y1=np.array([917918,918077,917901,918117,917911,918010,917831,917917,917713,917821,917802,917895,917837,918079,917968,918189,918110,918197,918176,918532,918379,918591,918525,918820,918741,918908,918895,919155,919043,919306,919311,919352,919384,919737,919660,919810,919812,920081,920061,920129,920239,920495,920378,920602,919718,919221,918349,917952,917186,916797,916420,916225,915777,915815,915590,915615,915494,915518,915172,915143,915014,914961,914850,914836,914736,914861,914634,914754,914600,914535,914338,914467,914058,914120,913738,913755,913535,913620,913421,913536,913370,913598,913430,913604,913332,913272,913032,913351,913149,913420,913452,913656,913457,913739,913491,913571,913546,913780,913733,913824,913853,914128,913905,914179,913948,914255,914137,914398,914218,914637,914647,915032,914972,915378,915458,915760,915788,916209,916424,916746,916789,917127,916994,916779,916151,915699,914815,914541,913697,913356,912676,912604,912085,911945,911421,911329,910773,910605,910070,910007,909365,909389,908914,908849,908138,907897,907135,906727,905948,905501,904563,904171,903516,902968,901669,901109,900140,899689,899185,899060,898337,898116,897321,897181,896671,896736,896482,896655,896470,896285,895870,895510,895131,895045,894808,895070,894919,895138,894940,894850,894573,894461,894250,894414,894283,894261,894073,893991,893759,893776,893611,893814,893845,894110,894075,894389,894404,894796,894820,895043,894756,894734,893946,893426,892740,892300,891639,891424,891004,891091,890708,891050,890630,890886,890513,890712,890286,890459,890191,890308,890092,890370,890220,890672,890356,890582,890360,890672,890590,890924,890571,890731,890382,890522,890300,890440,890276,890704,890630,890872,890784,891120,890952,891201,890979,891308,891214,891602,891463,891804,891851,892098,892030,892439,892290,892692,892726,893170,892947,893455,893221,893568,893603,893890,893823,894216,894111,894578,894383,894790,894790,895228,895148,895363,895071,894936,894392,894145,893451,893213,892719,892510,891995,891911,891565,891557,891155,891453,891187,891489,891323,891465,891326,891508,891362,891691,891699,892113,892045,892435,892686,893134,893193,893932,894305,894937,895296,896026,896267,897125,897504,898055,898475,899394,900062,901124,901781,902871,903546,904746,905236,906026,906586,907239,907538,908350,908789,909546,910001,910950,911197,912198,912574,913515,913947,914763,915216,916008,916358,917026,917587,918295,918580,918905,918641,918510,918064,917811,917377,917075,916639,916617,916340,916431,916285,916294,916138,916319,916233,916276,916127,916151,916187,916379,916387,916680,916645,916705,916712,916865,916753,916897,916794,916889,916753,916866,916880,917127,916954,917160,917274,917479,917399,917640,917681,918096,918073,918293,918523,918784,918794,919078,919219,919515,919664,919788,919884,920067,920253,920475,922228,922421,922546,922533,918442,918259,918043,918074,917901,917927,917853,917760,917759,917709,917630,917733,917828,917966,917982,918005,918123,918046,918113,918017,917899,917806,917937,917893,917811,917843,917889,917903,918113,918183,918217,918216,918362,918341,918585,918644,918664,918829,919094,919185,919180,919251,919561,919589,919733,919806,919886,919949,920231,920047,920337,920453,920561,920545,920866,920892,921791,921835,921996,921861,921468,920903,920584,919795,919433,918736,918500,917995,917777,917375,917290,917134,917058,916984,916815,916755,916855,916605,916735,916545,916687,916708,916786,916752,916853,916680,916820,916527,916494,916314,916430,916408,916267,916276,916257,916367,916395,916505,916606,916645,916734,916699,916915,916942,917067,917111,917177,917209,917366,917396,917568,917595,917678,917719,917807,917904,917970,918015,918328,918214,918358,918518,918682,918657,918839,918948,919135,919098,919000,918755,918281,917588,917234,916664,916348,915930,915546,915189,915073,914852,914843,914593,914746,914541,914414,914377,914364,914248,914297,914234,914408,914328,914451,914272,914392,914295,914292,914116,914047,913953,914061,914040,914081,913938,914133,914065,914344,914328,914421,914382,914616,914648,914780,914805,915046,915093,915215,915190,915311,915285,915440,915464,915777,915684,915890,915841,916099,915998,916276,916346,916432,916461,916539,916718,916966,917052,917329,917255,917571,917658,917893,917721,917807,917397,917096,916475,916018,915376,914760,914386,914062,913662,913445,913108,913124,912949,913017,912773,912800,912652,912570,912440,912382,912417,912468,912507,912559,912475,912505,912428,912394,912223,912259,912217,912110,912042,912074,911936,912120,912071,912081,912116,912175,912228,912318,912336,912533,912464,912782,912580,912818,912815,912969,912929,913153,913093,913316,913340,913574,913467,913677,913504,913733,913718,913752,913823,914058,914005,914227,914136,914354,914485,914641,914638,914935,914986,915171,915251,915484,915354,915204,914861,914553,913917,913388,912683,912364,911851,911676,911266,911215,910956,910983,910791,910901,910688,910671,910454,910508,910363,910428,910329,910482,910514,910717,910371,910449,910308,910449,910140,910176,910027,910078,909919,910087,909923,910112,909990,910230,910167,910466,910296,910536,910556,910827,910735,910852,910800,911053,910976,911346,911238,911446,911382,911638,911550,911745,911744,912012,911994,912123,912128,912224,912338,912478,912470,912680,912720,912987,912948,913318,913254,913475,913461,913875,913822,914047,913785,913529,912885,912535,912030,911601,910935,910662,910258,910088,909860,909787,909518,909634,909329,909378,909144,909329,909003,909141,908980,909042,909049,909265,909151,909206,909071,909224,909034,909117,908963,909008,908937,908955,908917,908965,908989,909103,909185,909213,909164,909491,909394,909535,909454,909788,909731,909961,909879,910133,910131,910330,910341,910617,910578,910803,910786,910988,910995,911219,911189,911366,911410,911639,911593,911838,911875,912146,912176,912413,912374,912634,912620,913023,913099,913417,913440,913693,913709,914134,914049,914375,914452,910634,910184,910190,909829,909819,909622,909755,909530,909646,909422,909533,909276,909376,909273,909526,909449,909721,909485,909708,909488,909608,909497,909435,909289,909436,909203,909380,909216,909418,909261,909546,909371,909611,909693,909889,909762,910010,910094,910229,910279,910610,910504,910817,910743,911016,910961,911276,911233,911420,911514,911664,911627,911922,911833,912208,912068,912307,912328,912583,912549,912927,912778,913096,913070,913383,913489,913697,913822,914107,914090,914357,914476,914690,914927,914886,914693,914557,913911,913608,912838,912505,911810,911485,911041,910985,910630,910625,910411,910530,910243,910380,910131,910414,910096,910222,910238,910403,910176,910476,910343,910544,910410,910562,910448,910494,910277,910387,910149,910336,910260,910371,910286,910411,910530,910760,910675,911015,910927,911210,911260,911435,911502,911691,911838,912088,911959,912260,912328,912552,912451,912803,912744,913013,913022,913275,913200,913540,913449,913741,913719,914092,914157,914291,914202,914580,914653,915026,914918,915336,915307,915738,915779,916071,916153,916610,916638,916967,917076,917341,917278,917323,916808,916329,915689,915251,914531,914094,913417,913055,912586,912487,912191,912184,911969,912074,911951,912060,911824,911890,911752,911817,911738,911895,911800,912035,911918,912057,911970,912084,911945,912026,911858,912022,911844,911889,911843,912022,911935,912100,912110,912347,912264,912517,912438,912756,912848,913019,912986,913290,913441,913608,913536,913911,913864,914097,914152,914351,914441,914772,914751,914937,914921,915247,915320,915525,915582,915794,915787,916110,916118,916362,916344,916691,916699,917047,917128,917494,917596,917995,918085,918424,918479,918740,918980,919350,919467,919767,919561,919478,918811,918257,917347,916925,916174,915602,915006,914925,914499,914349,914070,914221,913996,913964,913867,913976,913837,913918,913701,913977,913816,914034,913970,914215,914142,914204,914070,914249,914027,914069,913871,914043,913712,913965,913840,913920,913948,914188,914069,914376,914208,914549,914437,914747,914774,915096,914966,915279,915351,915497,915619,915931,915951,916180,916165,916352,916381,916683,916701,916834,916850,917074,917119,917402,917406,917673,917621,918017,917913,918140,918225,918623,918589,918872,919089,919365,919544,919863,919931,920252,920106,920062,919552,919184,918493,918042,917238,916915,916326,916035,915620,915476,915280,915254,915221,915274,915151,915176,915129,915195,915104,915235,915280,915383,915389,915606,915546,915628,915533,915544,915420,915332,915296,915296,915189,915247,915191,915303,915352,915433,915450,915670,915574,915866,915868,916083,916126,916415,916469,916805,916793,916939,917033,917315,917449,917530,917562,917994,917861,918147,918172,918496,918461,918698,918660,918962,918916,919201,919307,919600,919759,919989,920074,920369,920473,920867,920952,920985,920674,920330,919595,919180,918435,917888,917194,916818,916433,916194,915772,915762,915563,915547,915404,915473,915357,915328,915094,915241,915076,915172,915281,915444,915387,915560,915388,915434,915426,915402,915258,915218,915150,915264,915144,915319,915203,915338,915182,915538,915505,915642,915758,915919,916032,916079,916165,916414,916587,916714,916775,917034,917004,917206,917231,917423,917413,917675,917701,917810,917964,918155,918190,918382,918366,918705,918767,918906,918896,919137,919303,919590,919716,919975,919991,920410,920522,919074,918212,917686,917133,916702,916172,915956,915696,915425,915428,915257,915132,915139,915082,914972,914841,914784,914618,914660,914642,914742,914677,914794,914841,914768,914626,914635,914523,914437,914419,914424,914294,914427,914421,914577,914363,914680,914628,914737,914757,914888,915020,915046,915093,915290,915270,915490,915531,915828,915883,916033,915989,916150,916322,916379,916408,916621,916634,916752,916794,916969,916980,917223,917240,917535,917483,917669,917832,918111,918065,918300,918362,918640,918814,918955,919136,919421,919567,919702,919870,919850,919461,919032,918420,917753,917066,916485,916053,915371,915036,914821,914634,914439,914364,914304,914165,914036,914017,913871,913724,913687,913712,913704,913752,913717,913706,913925,913791,913756,913656,913641,913524,913404,913347,913369,913479,913435,913282,913369,913396,913486,913560,913559,913686,913860,913924,914050,914190,914156,914205,914361,914461,914577,914653,914730,914944,915062,915094,915173,915246,915390,915509,915518,915735,915773,915831,915999,916079,916117,916377,916358,916518,916600,916869,916989,917124,917316,917483,917627,917874,918079,918101,918045,917945,917454,917139,916374,915814,915338,914844,914379,914036,913643,913599,913347,913346,913107,913309,913132,913068,912977,912936,912891,912823,912795,913038,913067,913072,912978,913016,912948,912918,912810,912849,912784,912666,912650,912681,912603,912758,912691,912956,912822,913072,913071,913199,913217,913334,913533,913661,913661,913902,913927,914090,914168,914364,914295,914584,914627,914784,914879,914961,915039,915197,915277,915424,915381,915635,915659,915881,915969,916205,916278,916473,916497,916870,916808,916985,917258,917429,917567,917953,917963,918189,918389,918605,918560,918588,918231,917738,917120,916599,915788,915278,914824,914284,913845,913610,913323,913318,913000,913027,912897,912869,912679,912696,912569,912492,912408,912393,912329,912501,912474,912563,912492,912617,912432,912371,912370,912288,912167,912140,912137,912289,912278,912263,912197,912490,912530,912664,912683,912812,912742,913056,913034,913260,913413,913544,913538,913858,913790,914217,914168,914245,914288,914487,914511,914652,914696,914847,914938,915190,915214,915451,915492,915693,915747,916039,916103,916335,916333,916664,916682,917054,917101,917283,917509,917605,917792,918177,918195,918598,918596,919051,919057,919362,919311,919334,918759,918281,917596,916935,916140,915782,915113,914658,914089,913949,913668,913576,913421,913436,913438,913220,913177,913047,913017,912951,912874,912858,913016,913147,912999,913159,913188,913173,913103,913074,913010,913059,912896,912872,912775,912914,912947,913036,913100,913200,913232,913299,913387,913575,913612,913838,913935,914101,914139,914428,914424,914822,914759,914903,914997,915226,915243,915385,915536,915654,915680,915853,916022,916170,916186,916444,916335,916698,916790,916968,917054,917259,917365,917562,917651,917876,918056,918293,918488,918799,918927,919157,919369,919700,919811,920086,920258,920406,920062,919625,919046,918378,917655,917087,916482,916030,915503,915351,914927,914932,914729,914733,914657,914688,914614,914697,914526,914526,914485,914620,914694,914810,914943,914931,915006,915011,914952,914868,914857,914836,914703,914801,914804,914778,914794,914903,914865,915027,915110,915307,915237,915550,915630,915871,915943,916228,916299,916416,916466,916687,916922,917052,917253,917287,917427,917517,917548,917669,917959,918004,918159,918280,918506,918662,918784,919017,919157,919263,919526,919604,919723,919958,920109,920334,920460,920707,922721,922645,922030,921508,920781,920071,919418,918626,918120,917592,917214,916849,916680,916536,916364,916361,916267,916307,916156,916040,915962,915906,915915,915945,915958,916076,916104,916123,916104,916097,915954,915923,915886,915827,915819,915767,915806,915797,915793,915904,915990,916081,916119,916283,916373,916537,916658,916688,916989,917029,917171,917195,917408,917464,917786,917842,917985,918061,918246,918308,918455,918554,918711,918837,919004,919088,919221,919341,919528,919668,919738,920043,920187,920236,920429,920544,922448,922717,922990,923153,923427,923664,923801,923593,923243,922512,921783,920814,920147,919458,919027,918410,918056,917700,917552,917295,917233,917208,917258,917119,917058,916971,916928,916761,916888,916797,916964,917018,917095,916983,917106,917013,917004,916839,916878,916798,916722,916543,916640,916634,916743,916772,916881,916826,917046,917172,917375,917278,917507,917578,917799,917878,918000,918140,918356,918448,918652,918750,918879,918934,919051,919213,919263,919349,919604,919554,919856,919817,920088,920048,920277,920380,920652,920673,920915,920991,922856,923071,923337,923167,918179,917741,917583,917328,917231,917144,917111,917051,916934,916903,916921,916787,916816,916757,916903,916912,917055,917064,917165,916997,916939,916792,916828,916791])
    #y2=np.array([502263,502494,502453,502495,502345,502343,502374,502478,502251,502336,502256,502435,502249,502414,502342,502444,502379,502406,502429,502455,502445,502403,502282,502471,502450,502487,502434,502508,502527,502517,502450,502559,502542,502609,502514,502748,502675,502760,502690,502748,502665,502756,502687,502813,502247,502068,501840,501686,501447,501340,501207,501130,501039,501065,500890,500944,500868,500821,500799,500839,500673,500753,500642,500689,500641,500664,500600,500603,500480,500451,500390,500314,500227,500209,500107,500061,499970,500021,499760,499827,499744,499802,499676,499798,499569,499572,499383,499432,499293,499465,499440,499425,499422,499468,499326,499290,499198,499244,499069,499193,499111,499176,499230,499286,499100,499148,499007,499212,499118,499146,499149,499193,499260,499231,499341,499446,499411,499539,499519,499668,499669,499824,499797,499830,499660,499472,499321,499206,498869,498830,498664,498602,498450,498356,498122,498115,498004,497991,497591,497429,497395,497296,497160,496996,496809,496604,496393,495949,495630,495311,495142,494759,494496,494132,493689,493190,492767,492382,492126,491927,491791,491539,491264,490895,490677,490569,490456,490379,490306,490014,489976,489713,489493,489175,489111,489064,489164,489076,489063,489010,488850,488695,488613,488408,488621,488573,488520,488256,488171,488011,487915,487912,487963,488049,488066,487987,488121,488108,488189,488225,488228,488158,488052,487743,487610,487356,487230,487077,487151,487034,487002,486983,486994,486928,487019,486769,487035,486801,486899,486732,486813,486767,486779,486899,486908,486771,486849,486968,486963,486954,487114,486995,487040,486847,486863,486851,486951,486940,486874,486895,487104,487082,487086,486926,487028,487021,487045,486891,487017,486981,487063,487084,487296,487222,487379,487321,487453,487407,487496,487577,487673,487525,487704,487591,487851,487797,487839,487899,487958,487966,488045,487982,488020,488145,488178,488094,487980,487751,487735,487499,487434,487290,487287,487060,487153,486947,487040,486923,487014,487009,487053,486980,487095,487075,487056,486979,487154,487235,487450,487505,487699,487780,488009,488129,488493,488731,489125,489239,489696,489903,490206,490375,490788,490900,491444,491766,492211,492553,493098,493399,493855,494054,494515,494596,494998,495202,495572,495658,496089,496275,496739,496996,497321,497522,497991,498205,498614,498753,499076,499271,499602,499773,500122,500284,500517,500391,500589,500340,500258,500235,500223,500130,500233,500148,500335,500242,500303,500367,500437,500435,500431,500373,500408,500363,500558,500518,500483,500541,500585,500553,500711,500570,500656,500645,500704,500691,500805,500732,500875,500851,500845,500900,501055,500944,501058,501054,501262,501104,501334,501260,501399,501462,501510,501550,501648,501600,501715,501687,501837,501754,502476,502535,502651,502629,501589,501468,501471,501401,501568,501430,501591,501481,501471,501467,501539,501562,501541,501430,501635,501674,501710,501493,501663,501598,501694,501554,501545,501513,501590,501490,501659,501529,501734,501546,501707,501630,501680,501622,501767,501686,501795,501699,501890,501808,501923,501905,501985,501984,502085,502017,502073,502005,502172,502055,502235,502121,502240,502177,502274,502235,502539,502424,502612,502454,502532,502240,502231,501937,501869,501629,501553,501433,501413,501220,501259,501172,501236,501130,501211,501108,501095,501114,501143,501120,501267,501162,501210,501261,501320,501242,501211,501117,501224,501069,501158,501028,501075,501011,501084,501039,501175,501063,501208,501156,501190,501150,501211,501180,501253,501260,501291,501297,501389,501277,501381,501363,501446,501352,501610,501433,501577,501539,501581,501565,501649,501614,501681,501577,501821,501652,501834,501695,501755,501533,501652,501331,501197,501035,501020,500830,500768,500733,500669,500591,500715,500538,500626,500495,500727,500429,500655,500369,500565,500460,500512,500472,500609,500445,500637,500562,500615,500396,500495,500298,500457,500383,500431,500311,500540,500479,500599,500479,500593,500485,500727,500563,500689,500572,500779,500591,500818,500644,500916,500680,500834,500746,500954,500763,501005,500910,501058,500872,501090,500954,501124,501025,501155,501082,501339,501172,501363,501214,501386,501318,501479,501309,501444,501378,501381,501069,500993,500554,500704,500382,500437,500121,500239,500124,500205,499965,500084,499958,500140,499959,500079,499863,499924,499974,499978,499953,499976,499968,500089,499942,500076,499879,500101,499834,500054,499878,500020,499726,499864,499806,499944,499749,499876,499836,499992,499820,499901,499946,499996,499839,500029,499916,500093,499956,500154,499971,500185,500185,500232,500131,500273,500140,500305,500176,500292,500228,500406,500252,500394,500221,500409,500281,500422,500337,500411,500393,500567,500510,500625,500570,500605,500409,500465,500139,500064,499828,499781,499607,499569,499436,499494,499212,499325,499311,499362,499272,499313,499218,499210,499206,499239,499192,499172,499264,499323,499155,499359,499213,499318,499087,499163,499075,499139,498955,499062,498958,499213,499026,499168,499008,499265,499110,499249,499167,499289,499170,499314,499325,499475,499271,499385,499384,499537,499490,499566,499411,499525,499375,499626,499568,499607,499594,499629,499539,499800,499637,499821,499828,499832,499732,499909,499856,499891,499870,500098,500038,500203,500058,500016,499885,499772,499460,499436,499256,499242,498999,499064,498909,499080,498875,499034,498902,498972,498860,498910,498764,498938,498760,498874,498703,498997,498797,499003,498880,498976,498840,498963,498801,498988,498787,498835,498717,498879,498879,498950,498818,498939,498872,498963,498944,499098,498964,498980,499055,499189,499107,499150,499075,499204,499113,499279,499185,499245,499281,499389,499258,499522,499385,499469,499381,499543,499575,499577,499442,499666,499575,499758,499691,499822,499837,499841,499779,499922,499852,500031,500046,500047,500101,500237,500227,499139,499030,499088,499001,499107,499004,498993,498834,498943,498906,498949,498819,499022,498923,499003,498913,499131,499061,499004,499075,499099,498979,499033,498909,498936,498973,498880,498879,498996,498980,499056,498965,499043,499120,499207,498970,499137,499039,499198,499166,499281,499290,499327,499352,499400,499295,499478,499409,499553,499385,499607,499553,499643,499687,499717,499660,499812,499775,499882,499821,499902,499913,499986,500000,500111,500011,500082,500059,500162,500155,500339,500268,500394,500389,500506,500414,500331,500150,500139,499776,499824,499500,499573,499310,499334,499201,499322,499174,499237,499143,499182,499103,499239,499202,499243,499228,499294,499226,499230,499249,499310,499287,499346,499213,499361,499247,499240,499302,499344,499140,499377,499290,499315,499375,499422,499352,499445,499389,499531,499518,499545,499581,499702,499518,499775,499689,499722,499717,499916,499851,499791,499927,499948,499980,500025,500000,500075,500069,500184,500119,500211,500201,500361,500228,500369,500427,500480,500459,500601,500638,500700,500634,500914,500784,500824,500905,500981,500929,501056,501091,501218,501086,500981,500732,500552,500435,500218,500055,499981,499765,499884,499708,499820,499776,499756,499752,499710,499652,499741,499698,499693,499735,499750,499706,499923,499753,499892,499820,499887,499788,499864,499864,499838,499716,499759,499813,499829,499831,499865,499772,499950,499839,499899,499970,499993,499960,500038,500072,500126,500148,500178,500109,500230,500298,500394,500349,500485,500349,500517,500417,500610,500451,500593,500677,500668,500651,500684,500616,500729,500756,500972,500821,500927,500959,501000,501017,501076,501126,501253,501245,501379,501290,501529,501579,501576,501603,501799,501738,501769,501565,501421,501131,501136,500784,500769,500532,500465,500343,500409,500319,500358,500236,500369,500170,500307,500153,500267,500214,500229,500185,500323,500307,500420,500371,500396,500264,500403,500361,500475,500269,500272,500345,500475,500356,500432,500452,500408,500329,500453,500395,500435,500386,500518,500406,500580,500624,500643,500533,500763,500621,500782,500749,500849,500723,500919,500873,501040,500876,501001,500965,501090,501006,501253,501140,501242,501217,501268,501222,501362,501314,501358,501385,501532,501523,501524,501703,501804,501735,501814,501818,501930,501623,501655,501405,501298,501094,501053,500814,500806,500601,500664,500592,500557,500521,500495,500556,500652,500546,500728,500553,500664,500610,500709,500576,500724,500696,500734,500670,500789,500789,500741,500613,500718,500562,500655,500579,500667,500637,500808,500718,500763,500728,500853,500663,500814,500840,500945,500849,500971,500931,501118,501086,501237,501094,501248,501247,501342,501177,501279,501289,501398,501437,501471,501456,501599,501506,501613,501658,501774,501724,501827,501783,501915,501805,502068,502021,502204,502136,501996,501846,501668,501417,501375,501102,501030,501015,500975,500673,500772,500794,500715,500654,500708,500560,500704,500676,500682,500615,500764,500733,500743,500813,500886,500706,500924,500794,500907,500738,500913,500764,500859,500692,500903,500635,500866,500795,500851,500825,500960,500936,500871,500897,500966,500950,501046,501007,501129,501110,501112,501104,501239,501250,501294,501343,501443,501287,501491,501413,501578,501506,501641,501605,501684,501617,501723,501625,501823,501800,501829,501773,501832,501933,502091,502077,501762,501466,501458,501171,501112,500957,500991,500812,500998,500727,500798,500694,500736,500682,500793,500584,500794,500563,500625,500611,500748,500650,500811,500708,500764,500671,500737,500570,500660,500560,500629,500599,500664,500481,500629,500545,500727,500547,500801,500617,500798,500708,500813,500676,500893,500761,500841,500768,500984,500897,501035,500863,501093,500900,501044,501002,501132,501050,501220,501083,501231,501115,501312,501200,501327,501279,501390,501323,501547,501334,501531,501462,501583,501529,501664,501717,501682,501755,501971,501848,501961,501728,501747,501553,501401,501148,501203,500853,500903,500650,500602,500420,500480,500368,500450,500409,500460,500255,500490,500341,500396,500347,500322,500207,500430,500310,500426,500331,500467,500236,500406,500227,500377,500225,500293,500170,500333,500136,500334,500226,500399,500236,500360,500245,500540,500302,500424,500287,500494,500292,500587,500486,500569,500514,500614,500646,500716,500602,500787,500695,500847,500802,500881,500717,500858,500735,500955,500922,501074,500830,501079,500979,501145,500998,501269,501100,501289,501158,501298,501347,501440,501366,501552,501344,501345,501087,501112,500675,500761,500467,500463,500319,500260,500144,500168,500027,500218,499966,500250,500027,500197,500061,500164,499993,500125,499989,500325,500164,500286,499972,500252,500046,500213,500033,500137,499906,500082,500090,500215,499927,500225,500078,500182,500114,500274,500043,500231,500133,500421,500207,500286,500169,500385,500338,500517,500392,500558,500395,500573,500463,500652,500487,500694,500624,500836,500631,500834,500618,500860,500740,500977,500918,500998,500795,501069,500944,501242,501061,501268,501018,501269,501272,501409,501250,501647,501417,501631,501563,501655,501245,501258,500878,501031,500582,500592,500260,500336,500007,500169,499966,500244,500002,500154,500005,500031,499850,500073,499708,500052,499804,500020,499950,500136,499865,500006,499907,500020,499852,500154,499856,499987,499820,500003,499811,500009,499893,499975,499935,500052,499908,500156,499909,500124,500001,500213,500124,500346,500155,500398,500191,500479,500260,500465,500294,500520,500375,500474,500526,500651,500547,500703,500575,500742,500642,500870,500710,500909,500822,501021,500923,501105,500973,501208,501037,501261,501079,501273,501196,501431,501285,501503,501401,501711,501470,501714,501593,501780,501652,501693,501458,501346,501041,501064,500619,500689,500327,500577,500196,500457,500148,500280,500006,500240,499999,500149,499973,500147,500048,500178,499900,500077,500123,500254,500111,500297,500093,500296,500183,500211,500045,500186,500027,500247,500049,500192,500029,500295,500094,500389,500162,500328,500192,500394,500240,500487,500312,500456,500260,500652,500457,500684,500612,500798,500595,500871,500707,500917,500790,500881,500772,501018,500850,501053,500917,501032,500895,501183,501045,501294,501209,501353,501103,501447,501235,501494,501354,501613,501491,501726,501657,501864,501741,501967,501870,502149,501885,502165,501948,501821,501479,501460,501146,501247,500841,500847,500614,500606,500471,500740,500559,500808,500564,500665,500580,500728,500573,500821,500629,500830,500705,500961,500837,501043,500880,501081,500667,500889,500772,500953,500775,500969,500690,500928,500718,501047,500846,501044,500972,501135,501011,501185,501006,501393,500937,501332,501100,501500,501244,501405,501332,501556,501276,501634,501475,501723,501487,501782,501537,501844,501776,501971,501729,502015,501784,502086,501919,502184,501994,502262,502108,502311,502196,502506,502313,503021,502830,502991,502615,502578,502235,502234,501780,501827,501432,501626,501318,501395,501190,501293,501120,501265,501129,501427,501195,501426,501108,501362,501111,501253,501171,501381,501236,501436,501242,501419,501274,501370,501155,501405,501165,501179,501048,501328,501175,501323,501193,501313,501267,501383,501196,501434,501395,501463,501365,501510,501438,501686,501508,501640,501475,501773,501561,501798,501742,501867,501714,501972,501745,502054,501869,502083,501940,502139,502006,502289,502007,502286,502063,502368,502220,502783,502631,502884,502725,503145,502901,503271,502973,503068,502762,502770,502286,502227,501917,501908,501470,501718,501468,501545,501307,501455,501295,501490,501168,501451,501256,501474,501187,501405,501243,501411,501295,501458,501278,501567,501287,501481,501243,501453,501227,501405,501157,501404,501214,501373,501270,501416,501364,501505,501341,501536,501296,501601,501400,501612,501410,501728,501587,501859,501690,501823,501775,501986,501709,501986,501926,502100,501820,502178,501959,502181,502053,502274,502056,502408,502226,502362,502255,502440,502324,502923,502794,502995,502831,501710,501415,501442,501241,501505,501304,501431,501234,501421,501156,501409,501217,501402,501089,501434,501206,501463,501369,501568,501263,501536,501278,501410,501169])
    y1= [None for _ in range(x1.size())]
    for i in range(x1.size()):
        y1[i]=(x1.get(i))
    y2= [None for _ in range(x2.size())]
    for i in range(x2.size()):
        y2[i]=(x2.get(i))


    peak1_id,peak1_property = find_peaks(y1,distance=50)
    y11= [None for _ in range(x1.size())]
    for i in range(x1.size()):
            y11[i]=-1*(y1[i])
    slide1_id,slide1_property = find_peaks(y11,distance=50)
    peak1New=np.array([])
    slide1New=np.array([])
    for peak1Index in peak1_id:
        for slide1Index in slide1_id:
            if slide1Index-peak1Index>0 and slide1Index-peak1Index<40:
                peak1New=np.append(peak1New,peak1Index)
                slide1New=np.append(slide1New,slide1Index)



    peak2_id,peak2_property = find_peaks(y2,distance=50)
    y21= [None for _ in range(x2.size())]
    for i in range(x2.size()):
        y21[i]=-1*(y2[i])
    slide2_id,slide2_property = find_peaks(y21,distance=50)
    peak2New=np.array([])
    slide2New=np.array([])
    for peak2Index in peak2_id:
        for slide2Index in slide2_id:
            if slide2Index-peak2Index>0 and slide2Index-peak2Index<40:
                peak2New=np.append(peak2New,peak2Index)
                slide2New=np.append(slide2New,slide2Index)
    peak1New=peak1New.astype(int)
    slide1New=slide1New.astype(int)
    peak2New=peak2New.astype(int)
    slide2New=slide2New.astype(int)

    #求R值
    if len(peak1New)>1 and len(peak2New)>1:
        Phase=60 / ((peak2New[len(peak2New)-1]-peak2New[0])/100/(len(peak2New)-1))

        peak1max=y1[peak1New[0]]
        for peakTempIndex in peak1New:
            if y1[peakTempIndex]>peak1max :
                peak1max=y1[peakTempIndex]
        peak2max=y2[peak2New[0]]
        for peakTempIndex in peak2New:
            if y2[peakTempIndex]>peak2max :
                peak2max=y2[peakTempIndex]
        slide1min=y1[slide1New[0]]
        for slideTempIndex in slide1New:
            if y1[slideTempIndex]<slide1min :
                slide1min=y1[slideTempIndex]
        slide2min=y2[slide2New[0]]
        for slideTempIndex in slide2New:
            if y2[slideTempIndex]<slide2min :
                slide2min=y2[slideTempIndex]
        R= ((peak1max-slide1min)/peak1max)  / ((peak2max-slide2min)/peak2max)
        SPO2= -0.4337*R*R+1.4203*R-0.1799
    else:
        SPO2=0
        Phase=0

    return [SPO2,Phase]